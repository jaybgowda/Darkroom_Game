<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Darkroom Simulation Game</title>

<style>
  body { margin: 0; background: #000; overflow: hidden; }
  canvas { background: #111; display: block; margin: 0 auto; }

  /* ---------- TITLE SCREEN ---------- */
  #titleScreen {
    position: absolute; width:100%; height:100%; top:0; left:0;
    background:#000; color:white; display:flex; flex-direction:column;
    justify-content:center; align-items:center; font-family:Arial;
    z-index: 10;
  }
  #titleScreen h1 { font-size:40px; }
  #titleScreen button { padding:10px 20px; font-size:20px; cursor:pointer; }

  /* ---------- QUESTION BOX ---------- */
  #questionBox {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    background: #222;
    padding: 25px;
    width: 70%;
    max-width: 700px;
    border-radius: 12px;
    border: 3px solid #666;
    color: white;
    font-family: Arial;
    display: none;
    z-index: 20;
  }

  #qText {
    margin-bottom: 20px;
    font-size: 24px;
    font-weight: bold;
    text-align: center;
  }

  .choice {
    background: #333;
    padding: 15px;
    margin: 12px 0;
    border-radius: 10px;
    cursor: pointer;
    text-align: center;
    font-size: 20px;
  }
  .choice:hover { background:#555; }

  #lives {
    position:absolute; top:10px; left:10px;
    color:white; font-family:Arial; font-size:22px;
    z-index: 5;
  }

  #phoneOverlay {
    position:absolute; bottom:10px; right:10px;
    width:120px; height:200px;
    background:url('phone.png');
    background-size:cover;
    z-index: 5;
  }
</style>
</head>
<body>

<!-- TITLE SCREEN -->
<div id="titleScreen">
  <h1>October/November Book Project</h1>
  <h2>Darkroom Simulation</h2>
  <p>Created by: Jay Gowda</p>
  <button onclick="startGame()">Start</button>
</div>

<!-- GAME CANVAS -->
<canvas id="gameCanvas" width="900" height="900"></canvas>
<div id="lives">Lives: 3</div>
<div id="phoneOverlay"></div>

<!-- QUESTION BOX -->
<div id="questionBox">
  <div id="qText"></div>
  <div id="choices"></div>
</div>

<script>
/* ---------- SETUP ---------- */

let canvas = document.getElementById("gameCanvas");
let ctx = canvas.getContext("2d");

let player = { x:450, y:450, size:25, speed:5 };
let ghosts = [];
let lives = 3;
let quizActive = false;

let snd = new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg");

let rooms = [
  {x:50,y:50,w:350,h:350},
  {x:500,y:50,w:350,h:350},
  {x:50,y:500,w:350,h:350},
  {x:500,y:500,w:350,h:350}
];

/* ---------- START GAME ---------- */
function startGame(){
  document.getElementById("titleScreen").style.display = "none";
  spawnGhosts();
  gameLoop();
}

/* ---------- GHOSTS ---------- */
function spawnGhosts(){
  for(let i=0;i<5;i++){
    ghosts.push({
      x: Math.random()*800+50,
      y: Math.random()*800+50,
      size: 20,
      dx: Math.random()*2-1,
      dy: Math.random()*2-1
    });
  }
}

function animateGhosts(){
  ghosts.forEach(g=>{
    g.x += g.dx;
    g.y += g.dy;

    if(g.x < 0 || g.x > 900) g.dx *= -1;
    if(g.y < 0 || g.y > 900) g.dy *= -1;
  });
}

/* ---------- MOVEMENT ---------- */
let keys = {};

document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

function movePlayer(){
  if(quizActive) return;

  if(keys["ArrowUp"]) player.y -= player.speed;
  if(keys["ArrowDown"]) player.y += player.speed;
  if(keys["ArrowLeft"]) player.x -= player.speed;
  if(keys["ArrowRight"]) player.x += player.speed;
}

/* ---------- QUESTIONS ---------- */

const questions = [
  {
    q: "Why does Riley start using the darkroom?",
    c: [
      "To explore strange figures appearing in her photos",
      "To learn film photography for fun",
      "Because her teacher assigned it",
      "To avoid being around her family"
    ],
    a: 0
  },
  {
    q: "What appears in Rileyâ€™s photos that scares her?",
    c: [
      "A shadowy figure",
      "A bright flash of light",
      "Distorted landscapes",
      "Her camera lens cracking"
    ],
    a: 0
  },
  {
    q: "Where does most of the investigation take place?",
    c: ["The cafeteria","The darkroom","The library","Outside the school"],
    a: 1
  },
  {
    q: "What emotion does Riley feel as the ghost images increase?",
    c: ["Excitement","Confusion","Fear","Calmness"],
    a: 2
  },
  {
    q: "What device helps Riley understand the ghostly images?",
    c: ["Her phone","A flashlight","A thermometer","A video camera"],
    a: 0
  },
  {
    q: "What does the mysterious figure in the photos seem to want?",
    c: ["To warn Riley","To harm her","To steal her camera","Nothing"],
    a: 0
  }
];

/* ---------- QUESTION BOX ---------- */

function showQuestion(){
  quizActive = true;
  snd.play();

  let q = questions[Math.floor(Math.random()*questions.length)];

  let qb = document.getElementById("questionBox");
  qb.style.display = "block";

  document.getElementById("qText").innerText = q.q;

  let cBox = document.getElementById("choices");
  cBox.innerHTML = "";

  q.c.forEach((choice, i)=>{
    let div = document.createElement("div");
    div.className = "choice";
    div.innerText = choice;
    div.onclick = ()=>handleAnswer(i === q.a);
    cBox.appendChild(div);
  });
}

function handleAnswer(correct){
  if(!correct){
    lives--;
    document.getElementById("lives").innerText = "Lives: " + lives;

    if(lives <= 0){
      alert("GAME OVER!");
      location.reload();
    }
  }

  document.getElementById("questionBox").style.display = "none";
  quizActive = false;
}

/* ---------- COLLISION ---------- */
function checkCollision(){
  if(quizActive) return;

  ghosts.forEach(g=>{
    let dx = player.x - g.x;
    let dy = player.y - g.y;
    let d = Math.sqrt(dx*dx + dy*dy);

    if(d < 35){
      showQuestion();
    }
  });
}

/* ---------- DRAW ---------- */
function draw(){
  ctx.clearRect(0,0,900,900);

  rooms.forEach(r=>{
    ctx.fillStyle = "#222";
    ctx.fillRect(r.x,r.y,r.w,r.h);
  });

  ctx.fillStyle = "cyan";
  ctx.fillRect(player.x, player.y, player.size, player.size);

  ctx.fillStyle = "red";
  ghosts.forEach(g=>{
    ctx.beginPath();
    ctx.arc(g.x, g.y, g.size, 0, Math.PI*2);
    ctx.fill();
  });
}

/* ---------- GAME LOOP ---------- */
function gameLoop(){
  movePlayer();
  animateGhosts();
  checkCollision();
  draw();
  requestAnimationFrame(gameLoop);
}
</script>
</body>
</html>
